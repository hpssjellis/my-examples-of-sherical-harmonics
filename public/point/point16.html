<!DOCTYPE html>
<html>
<head>
    <title>Configurable JSON Point Cloud Generator</title>
    <style>
        body { font-family: sans-serif; padding: 20px; }
        h1 { font-size: 1.5em; }
        /* Minimal inline CSS preference */
        .myControlGroup { 
            margin-bottom: 20px; 
            display: flex; 
            align-items: center; 
            gap: 15px;
        }
        #myPointCountInput { 
            padding: 8px; 
            font-size: 1em; 
            width: 100px; 
            border: 1px solid #ccc; 
            border-radius: 4px;
        }
        #myGenerateButton { 
            padding: 10px 20px; 
            font-size: 1em; 
            cursor: pointer; 
            background-color: #007bff; /* Changed color for better contrast with the input */
            color: white; 
            border: none; 
            border-radius: 5px;
        }
        #myJsonOutput { 
            width: 100%; 
            height: 500px; 
            margin-top: 15px; 
            padding: 10px; 
            font-family: monospace; 
            font-size: 0.9em; 
            white-space: pre; 
            overflow: auto; 
            border: 1px solid #ccc; 
        }
    </style>
</head>
<body>
    <h1>Configurable Point Cloud Generator</h1>
    <p>Set the number of points and click **"Generate JSON"**.</p>
    
    <div class="myControlGroup">
        <label for="myPointCountInput">Number of Points:</label>
        <input type="number" id="myPointCountInput" value="5000" min="100" step="100" onchange="myUpdateCount()">
        
        <button id="myGenerateButton" onclick="myGenerateJson()">Generate JSON</button>
    </div>

    <textarea id="myJsonOutput" placeholder="JSON data will appear here after you click the button."></textarea>

    <script>
        // Use a variable to hold the point count, initialized from the input's default value
        let myCurrentPointCount = 5000;
        
        // Function to update the global count variable when the input field changes
        function myUpdateCount() {
            const myInput = document.getElementById("myPointCountInput");
            const myValue = parseInt(myInput.value);
            
            // Basic validation: ensure the value is a positive number
            if (myValue > 0) {
                myCurrentPointCount = myValue;
                // Clear output and reset button text when count is changed
                document.getElementById("myJsonOutput").value = '';
                document.getElementById("myGenerateButton").textContent = "Generate JSON";
            } else {
                alert("Please enter a positive number for the point count.");
                // Resetting the input to a safe value if the user enters something invalid
                myInput.value = myCurrentPointCount; 
            }
        }

        // Function to generate coordinates for a simple capsule/cylinder shape
        function myShapeDogBody(myNumPoints) {
            const myPositions = [];
            
            // Parameters for the capsule shape
            const myBodyRadius = 1.0;
            const myBodyLength = 2.5;
            const myHeadOffset = 0.5;
            let myCount = 0;

            // Loop until we have enough points
            while (myCount < myNumPoints) {
                let myX = (Math.random() * 2 - 1) * myBodyLength / 2;
                let myY = (Math.random() * 2 - 1) * myBodyRadius;
                let myZ = (Math.random() * 2 - 1) * myBodyRadius;

                let myIncludePoint = false;
                
                // Check if inside the main body cylinder
                if (Math.abs(myX) <= myBodyLength / 2 - myBodyRadius) {
                    if (myY * myY + myZ * myZ <= myBodyRadius * myBodyRadius) {
                        myIncludePoint = true;
                    }
                } 
                // Check if inside the spherical caps at the ends
                else {
                    let myEndDist = Math.abs(myX) - (myBodyLength / 2 - myBodyRadius);
                    if (myEndDist * myEndDist + myY * myY + myZ * myZ <= myBodyRadius * myBodyRadius) {
                        myIncludePoint = true;
                    }
                }
                
                // Add a small cluster for a "head" near one end (positive X)
                if (Math.random() < 0.05) { 
                     myX = myBodyLength / 2 + myHeadOffset + (Math.random() * 0.4 - 0.2);
                     myY = Math.random() * 0.5;
                     myZ = Math.random() * 0.5 - 0.25;
                     myIncludePoint = true;
                }
                
                if (myIncludePoint) {
                    // Add the position to the array
                    myPositions.push(
                        parseFloat(myX.toFixed(3)), 
                        parseFloat(myY.toFixed(3)),
                        parseFloat(myZ.toFixed(3))
                    );
                    myCount++;
                }
            }
            return myPositions;
        }

        /**
         * Main function to build and display the JSON.
         * Called by the button click.
         */
        async function myGenerateJson() {
            // Use the globally updated count
            const myPositionsData = myShapeDogBody(myCurrentPointCount);

            const myDogJson = {
                "myPointCount": myPositionsData.length / 3,
                "myPositionsArray": myPositionsData 
            };

            const myOutputElement = document.getElementById("myJsonOutput");
            
            // Format the JSON with 2-space indentation for readability
            myOutputElement.value = JSON.stringify(myDogJson, null, 2);
            
            // Update button text to confirm action
            document.getElementById("myGenerateButton").textContent = `JSON Generated! (${myDogJson.myPointCount} Points)`;
        }
    </script>
</body>
</html>
